\documentclass[conference]{IEEEtran}
\IEEEoverridecommandlockouts
% The preceding line is only needed to identify funding in the first footnote. If that is unneeded, please comment it out.
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}
\begin{document}

\title{Electric appliance signature Project using CNN's}


\author{\IEEEauthorblockN{1\textsuperscript{st} Antonio Abreu}
\IEEEauthorblockA{\textit{DEE - Departamento de Eng.ª Eletrotécnica} \\
\textit{Polytecnics Institute of Setubal}\\
Setubal, Portugal \\
antonio.abreu@estsetubal.ips.pt}
\and
\IEEEauthorblockN{2\textsuperscript{nd} Joao Santos}
\IEEEauthorblockA{\textit{DEE - Departamento de Eng.ª Eletrotécnica} \\
\textit{Polytecnics Institute of Setubal}\\
Setubal, Portugal \\
joao.jcs@hotmail.com}
}

\maketitle

\begin{abstract}
This was a very important project that was made for a subject that is {\it Embebed Systems\/} where it combines two important science fields in Eletrotecnic and Computer Engineering course, wich is Eletric waves analysis and Computer Science.
\end{abstract}

\begin{IEEEkeywords}
Waves, Machine Learning, Eletrotecnics, Computer Science
\end{IEEEkeywords}

\section{Introduction}
This project have the goal to measure electric current in some speciefic home equipments and create a digital footprint of it, so that we can distiguish between this equipments and classify it. This can have multiple applications for exemple in the prediction issues in the functionality, and have a knowledge about charging times of some equipments.
The aproach to classify this equipments was by obtaining some samples of current wave using a Hall efect sensor and then creating a spectogram image of it, and applying a pretrained model of CNN({\it Convolutional Neural Network}) to classify the equipment.


\section{First Aproach}

\subsection{Creating a basic solution}

The goal of this project is to classify equipments AC current waves so, to start working on this project first, was created a wave generator so that we could have the abbility to make a dummy dataset and start to make some trainings and predictions. To do that was created 3 types of waves all the samples with added noise. After having the waves in the dataset was created a spectogram of the wave which at the {\it x} axis we have the time domain and in the {\it y} axis we have the frequency domain. So for a sine wave with some random noise we got the following patern.
\begin{figure}[htbp]
\centerline{\includegraphics[scale=0.2]{specgramsinwave.png}}
\caption{Spectogram of a sine wave with noise.}
\label{fig}
\end{figure}
So that we can see the 50{\it Hz} line in white
With this spectograms for 3 kind of different waves our goal is to classify it and for that there is a need for using an machine learning algorithm.
\section{Choosing the right ML algorithm}

In order to do calssifications in spectogram images, the best algorithm to look for patterns in images is neural networks, with some research we've found a very powerfull algorithm for this kind of tasks the CNN({\it Convolutional Neural Network}) this kind of algorithms are capable of extacting spatial and temporal dependencies in an image. This technique works in a similar way of a Visual Cortex of the Human body as we can see in the figure 2.
\begin{figure}[htbp]
\centerline{\includegraphics[scale=0.19]{cnndemo.png}}
\caption{CNN sequence.}
\label{fig}
\end{figure}
With this technique for the generated waves in a demo of 1200 samples we could achieve accuracies in between [{90 - 99}]{\%} So we were ready to start doing the real tests.

\section{Real life tests}

\subsection{Gathering current waves information}\label{AA}
The first aproach to make real life tests was to get the current waves information of some equipments, for that was used an AC current sensor we choosed the ACS712 wich is capable to measure AC currents up to 20 {\it A} this device consists in a linear Hall efect wich the current is applied through a cooper where it generates a magnetic field than it's measured by an Hall efect integrated circuit.
So to gather the information of the circuit was used an ESP8266 where the output of the sensor was connected to the 10bit ADC of this microcontroler. In order to display the data and to be possible the data management to transform it into an spectogram each sample of 60ms was sent to a server in this case an laptop through TCP connectivity where we could achieve around 350 sample that is arround 6 samples/ms as a result we could get this type of wave when a laptop and candle is connected:
\begin{figure}[htbp]
\centerline{\includegraphics[scale=0.4]{lastwave.png}}
\caption{AC current of 2 equipments.}
\label{fig}
\end{figure}
\subsection{Preparing data to analyse}
To prepare the data we made 3 labels in order to train the {\it neural network} the first sample was only the computer, than the candle lamp, and then both equipments together labeled in numbers 0,1,2 after collecting around 970 looking for the header of the Dataframe in figure 3. we can see the label, the array of the wave values, and it's effective value this output was made by the python library pandas.
\begin{figure}[htbp]
\centerline{\includegraphics[scale=0.4]{Datasetresume.png}}
\caption{Print of the dataframe header.}
\label{fig}
\end{figure}


After having the data of each wave and it's classification was made the spectogram in sequence to train it trought the {\it CNN} for that spectogram 


\begin{figure}[htbp]
\centerline{\includegraphics[scale=0.45]{lastwavespecgram.png}}
\caption{Spectogram of the Fig. 3. wave.}
\label{fig}
\end{figure}

\subsection{Some Common Mistakes}\label{SCM}
\begin{itemize}
\item The word ``data'' is plural, not singular.
\item The subscript for the permeability of vacuum $\mu_{0}$, and other common scientific constants, is zero with subscript formatting, not a lowercase letter ``o''.
\item In American English, commas, semicolons, periods, question and exclamation marks are located within quotation marks only when a complete thought or name is cited, such as a title or full quotation. When quotation marks are used, instead of a bold or italic typeface, to highlight a word or phrase, punctuation should appear outside of the quotation marks. A parenthetical phrase or statement at the end of a sentence is punctuated outside of the closing parenthesis (like this). (A parenthetical sentence is punctuated within the parentheses.)
\item A graph within a graph is an ``inset'', not an ``insert''. The word alternatively is preferred to the word ``alternately'' (unless you really mean something that alternates).
\item Do not use the word ``essentially'' to mean ``approximately'' or ``effectively''.
\item In your paper title, if the words ``that uses'' can accurately replace the word ``using'', capitalize the ``u''; if not, keep using lower-cased.
\item Be aware of the different meanings of the homophones ``affect'' and ``effect'', ``complement'' and ``compliment'', ``discreet'' and ``discrete'', ``principal'' and ``principle''.
\item Do not confuse ``imply'' and ``infer''.
\item The prefix ``non'' is not a word; it should be joined to the word it modifies, usually without a hyphen.
\item There is no period after the ``et'' in the Latin abbreviation ``et al.''.
\item The abbreviation ``i.e.'' means ``that is'', and the abbreviation ``e.g.'' means ``for example''.
\end{itemize}
An excellent style manual for science writers is \cite{b7}.

\subsection{Authors and Affiliations}
\textbf{The class file is designed for, but not limited to, six authors.} A 
minimum of one author is required for all conference articles. Author names 
should be listed starting from left to right and then moving down to the 
next line. This is the author sequence that will be used in future citations 
and by indexing services. Names should not be listed in columns nor group by 
affiliation. Please keep your affiliations as succinct as possible (for 
example, do not differentiate among departments of the same organization).

\subsection{Identify the Headings}
Headings, or heads, are organizational devices that guide the reader through 
your paper. There are two types: component heads and text heads.

Component heads identify the different components of your paper and are not 
topically subordinate to each other. Examples include Acknowledgments and 
References and, for these, the correct style to use is ``Heading 5''. Use 
``figure caption'' for your Figure captions, and ``table head'' for your 
table title. Run-in heads, such as ``Abstract'', will require you to apply a 
style (in this case, italic) in addition to the style provided by the drop 
down menu to differentiate the head from the text.

Text heads organize the topics on a relational, hierarchical basis. For 
example, the paper title is the primary text head because all subsequent 
material relates and elaborates on this one topic. If there are two or more 
sub-topics, the next level head (uppercase Roman numerals) should be used 
and, conversely, if there are not at least two sub-topics, then no subheads 
should be introduced.

\subsection{Figures and Tables}
\paragraph{Positioning Figures and Tables} Place figures and tables at the top and 
bottom of columns. Avoid placing them in the middle of columns. Large 
figures and tables may span across both columns. Figure captions should be 
below the figures; table heads should appear above the tables. Insert 
figures and tables after they are cited in the text. Use the abbreviation 
``Fig.~\ref{fig}'', even at the beginning of a sentence.

\begin{table}[htbp]
\caption{Table Type Styles}
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
\textbf{Table}&\multicolumn{3}{|c|}{\textbf{Table Column Head}} \\
\cline{2-4} 
\textbf{Head} & \textbf{\textit{Table column subhead}}& \textbf{\textit{Subhead}}& \textbf{\textit{Subhead}} \\
\hline
copy& More table copy$^{\mathrm{a}}$& &  \\
\hline
\multicolumn{4}{l}{$^{\mathrm{a}}$Sample of a Table footnote.}
\end{tabular}
\label{tab1}
\end{center}
\end{table}


Figure Labels: Use 8 point Times New Roman for Figure labels. Use words 
rather than symbols or abbreviations when writing Figure axis labels to 
avoid confusing the reader. As an example, write the quantity 
``Magnetization'', or ``Magnetization, M'', not just ``M''. If including 
units in the label, present them within parentheses. Do not label axes only 
with units. In the example, write ``Magnetization (A/m)'' or ``Magnetization 
\{A[m(1)]\}'', not just ``A/m''. Do not label axes with a ratio of 
quantities and units. For example, write ``Temperature (K)'', not 
``Temperature/K''.

\section*{Acknowledgment}

The preferred spelling of the word ``acknowledgment'' in America is without 
an ``e'' after the ``g''. Avoid the stilted expression ``one of us (R. B. 
G.) thanks $\ldots$''. Instead, try ``R. B. G. thanks$\ldots$''. Put sponsor 
acknowledgments in the unnumbered footnote on the first page.

\section*{References}

Please number citations consecutively within brackets \cite{b1}. The 
sentence punctuation follows the bracket \cite{b2}. Refer simply to the reference 
number, as in \cite{b3}---do not use ``Ref. \cite{b3}'' or ``reference \cite{b3}'' except at 
the beginning of a sentence: ``Reference \cite{b3} was the first $\ldots$''

Number footnotes separately in superscripts. Place the actual footnote at 
the bottom of the column in which it was cited. Do not put footnotes in the 
abstract or reference list. Use letters for table footnotes.

Unless there are six authors or more give all authors' names; do not use 
``et al.''. Papers that have not been published, even if they have been 
submitted for publication, should be cited as ``unpublished'' \cite{b4}. Papers 
that have been accepted for publication should be cited as ``in press'' \cite{b5}. 
Capitalize only the first word in a paper title, except for proper nouns and 
element symbols.

For papers published in translation journals, please give the English 
citation first, followed by the original foreign-language citation \cite{b6}.

\begin{thebibliography}{00}
\bibitem{b1} G. Eason, B. Noble, and I. N. Sneddon, ``On certain integrals of Lipschitz-Hankel type involving products of Bessel functions,'' Phil. Trans. Roy. Soc. London, vol. A247, pp. 529--551, April 1955.
\bibitem{b2} J. Clerk Maxwell, A Treatise on Electricity and Magnetism, 3rd ed., vol. 2. Oxford: Clarendon, 1892, pp.68--73.
\bibitem{b3} I. S. Jacobs and C. P. Bean, ``Fine particles, thin films and exchange anisotropy,'' in Magnetism, vol. III, G. T. Rado and H. Suhl, Eds. New York: Academic, 1963, pp. 271--350.
\bibitem{b4} K. Elissa, ``Title of paper if known,'' unpublished.
\bibitem{b5} R. Nicole, ``Title of paper with only first word capitalized,'' J. Name Stand. Abbrev., in press.
\bibitem{b6} Y. Yorozu, M. Hirano, K. Oka, and Y. Tagawa, ``Electron spectroscopy studies on magneto-optical media and plastic substrate interface,'' IEEE Transl. J. Magn. Japan, vol. 2, pp. 740--741, August 1987 [Digests 9th Annual Conf. Magnetics Japan, p. 301, 1982].
\bibitem{b7} M. Young, The Technical Writer's Handbook. Mill Valley, CA: University Science, 1989.
\end{thebibliography}
\vspace{12pt}
\color{red}
IEEE conference templates contain guidance text for composing and formatting conference papers. Please ensure that all template text is removed from your conference paper prior to submission to the conference. Failure to remove the template text from your paper may result in your paper not being published.

https://towardsdatascience.com/getting-to-know-the-mel-spectrogram-31bca3e2d9d0
https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53

\end{document}
